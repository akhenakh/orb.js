var Orb;(Orb=Orb||{}).Storage=Orb.Storage||{},Orb.Constant=Orb.Constant||{PI:Math.PI,RAD:Math.PI/180,AU:149597870.7,RE:6378.137,LD:384e3,LY:Number("9.46073E+12"),PC:Number("3.08568E+13"),G:Number("6.6740831E-11"),GM:2.9591220828559095*Math.pow(10,-4),Planets:["Sun","Mercury","Venus","Earth","Moon","Mars","Jupiter","Saturn","Uranus","Neptune"],Sun:{radius:696019,obliquity:7.25,mass:Number("1.989E+30"),gm:Number("1.327124400189E+11")},Mercury:{radius:2439.7,obliquity:.027,mass:Number("3.301E+23"),gm:220329},Venus:{radius:6051.8,obliquity:177.36,mass:Number("4.867E+24"),gm:3248599},Earth:{radius:6378.15,obliquity:23.435,mass:Number("5.972E+24"),gm:Number("3.9860044189E+5")},Moon:{radius:1737.4,obliquity:1.5424,mass:Number("7.346E+22"),gm:4904.86959},Mars:{radius:3397.2,obliquity:25,mass:Number("6.417E+24"),gm:42828.9},Jupiter:{radius:71492,obliquity:3.08,mass:Number("1.899E+27"),gm:1266865349},Saturn:{radius:60268,obliquity:26.7,mass:Number("5.685E+26"),gm:379311879},Uranus:{radius:25559,obliquity:97.9,mass:Number("8.682E+26"),gm:57939399},Neptune:{radius:24786,obliquity:29.6,mass:Number("1.024E+26"),gm:68365299}},Orb.Const=Orb.Constant,Orb.RoundAngle=Orb.RoundAngle||function(t){var r=t%360;return r<0&&(r+=360),r},Orb.NutationAndObliquity=Orb.NutationAndObliquity||function(t){var r=Orb.Constant.RAD,e=(new Orb.Time(t).jd()-2451545)/36525,a=(125.04452-1934.136261*e+.0020708*e*e+(e*e+e)/45e4)*r,n=(280.4665+36000.7698*e)*r,i=(218.3165+481267.8813*e)*r;return{nutation:function(){return-17.2/3600*Math.sin(a)- -1.32/3600*Math.sin(2*n)-.23/3600*Math.sin(2*i)+.21/3600*Math.sin(2*a)/r},obliquity:function(){return 23.43929111111111-46.815/3600*e-59e-5/3600*e*e+.001813/3600*e*e*e+(9.2/3600*Math.cos(a)+.57/3600*Math.cos(2*n)+.1/3600*Math.cos(2*i)-.09/3600*Math.cos(2*a))}}},Orb.Obliquity=Orb.Obliquity||function(t){return new Orb.NutationAndObliquity(t).obliquity()},Orb.Time=Orb.Time||function(t){if(t)r=t;else var r=new Date;var e=function(t){return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hours:t.getUTCHours(),minutes:t.getUTCMinutes(),seconds:t.getUTCSeconds()}}(r),a=function(){return e.hours/24+e.minutes/1440+e.seconds/86400},n=function(){var t=e.year,r=e.month,a=e.day;if(r<=2)var t=t-1,r=r+12;var n=Math.floor(365.25*(t+4716))+Math.floor(30.6001*(r+1))+a-1524.5;if(n<2299160.5)u=0;else var i=Math.floor(t/100),u=2-i+Math.floor(i/4);return n+u};return{date:r,year:Number(e.year),month:Number(e.month),day:Number(e.day),hours:Number(e.hours),minutes:Number(e.minutes),seconds:Number(e.seconds),time_in_day:function(){return a()},jd:function(){return n()+a()},gmst:function(){return function(){var t=Orb.Constant.RAD,r=3600*e.hours+60*e.minutes+e.seconds,a=(n()-2451545)/36525,i=(24110.5484+8640184.812866*a+.093104*a*a+62e-7*a*a*a)/3600;i>24&&(i%=24);var u=i+1.00273790925*r/3600,o=23.43929111111111-46.815/3600*a-59e-5/3600*a*a+.001813/3600*a*a*a,s=125.04452-1934.136261*a+.0020708*a*a+a*a*a/45e4,b=280.4665+36000.7698*a,c=218.3165+481267.8813*a;return(u+=(-17.2*Math.sin(s*t)- -1.32*Math.sin(2*b*t)-.23*Math.sin(2*c*t)+.21*Math.sin(2*s*t))/15*Math.cos(o*t)/3600)<0&&(u=u%24+24),u>24&&(u%=24),u}()},doy:function(){return function(){var t=r,e=new Date(Date.UTC(t.getFullYear()-1,11,31,0,0,0));return((t.getTime()-t.getTimezoneOffset()-e.getTime())/864e5).toFixed(8)}()}}},Orb.RadecToXYZ=function(t){var r=Orb.Const.RAD,e=15*t.ra,a=t.dec,n=t.distance,i={x:n*Math.cos(a*r)*Math.cos(e*r),y:n*Math.cos(a*r)*Math.sin(e*r),z:n*Math.sin(a*r)};return{x:i.x,y:i.y,z:i.z,coordinate_keywords:"equatorial rectangular",unit_keywords:""}},Orb.XYZtoRadec=function(t){if(t.coordinate_keywords&&t.coordinate_keywords.match(/ecliptic/)){if(t.date)r=t.date;else var r=new Date;e=Orb.EclipticToEquatorial({date:r,ecliptic:t})}else var e=t;var a=Math.PI/180,n=e.x,i=e.y,u=e.z,o=Math.atan2(i,n)/a;o<0&&(o=o%360+360),o>360&&(o%=360);return{ra:o/=15,dec:Math.atan2(u,Math.sqrt(n*n+i*i))/a,distance:Math.sqrt(n*n+i*i+u*u),coordinate_keywords:"equatorial spherical",unit_keywords:"hours degree"}},Orb.EquatorialToEcliptic=function(t){var r=t.date,e=Orb.Obliquity(r),a=t.equatorial,n=Orb.Const.RAD,i={x:a.x,y:Math.cos(e*n)*a.y+Math.sin(e*n)*a.z,z:-Math.sin(e*n)*a.y+Math.cos(e*n)*a.z};return{x:i.x,y:i.y,z:i.z,date:r,coordinate_keywords:"ecliptic rectangular",unit_keywords:""}},Orb.EclipticToEquatorial=function(t){var r=t.date,e=t.ecliptic,a=Orb.Const.RAD,n=new Orb.VSOP("Earth").xyz(r),i=e.x-n.x,u=e.y-n.y,o=e.z-n.z,s=Orb.Obliquity(t.date),b={x:i,y:u*Math.cos(s*a)-o*Math.sin(s*a),z:u*Math.sin(s*a)+o*Math.cos(s*a)};return{x:b.x,y:b.y,z:b.z,date:r,coordinate_keywords:"equatorial rectangular",unit_keywords:""}};